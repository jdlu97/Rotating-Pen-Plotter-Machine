<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Term Project: Glass Pen Plotter: Term Project: Glass Pen Plotter</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Term Project: Glass Pen Plotter
   </div>
   <div id="projectbrief">Documentation for the Mechatronics Term Project</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Term Project: Glass Pen Plotter </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This is an overview of the software design of the term project for the Mechatronics course at California Polytechnic State University.The student self-funded project consists of a two and one-half axis machine that draws a image on the surface of a pint glass. One axis is a rotating base, a second axis a vertical up/down motion, and the third, half axis is the in/out motion of the marker/pen that plots the image.</p>
<h1><a class="anchor" id="software"></a>
Software Design</h1>
<p >Four tasks allow our system, called "pen plotter" for brevity, to achieve its desired functionality. Two of these tasks are provided by the instructor and accomplish cooperative multitasking and data sharing. The other two, are an encoder tasks to read the position of the motor and a motor-controller task that sets the motor percent duty cycle that corresponds to the setpoint or desired value of position. Because there are two motors for each full axis, there are two motor controller tasks, each with an associated encoder task. Thus, a total of six tasks. However, excluding the ones related to cooperative multitasking and data sharing for purposes of defining a task diagram, we have four tasks in total.</p>
<p >The task diagram for the overall project is shown below. It is worth noting that while "x" is used to represent one of the axis, it can also be thought of as a "theta" axis, due to the rotating base creating the motion.</p>
<p > <style> div.image img[src = "term_proj_task_diagram.png"]{width:700px}
                </style>
    </p>
<div class="image">
<img src="term_proj_task_diagram.png" alt=""/>
<div class="caption">
Term Project Task Diagram</div></div>
<p >For simplicity, there is no user task. The main script for the program is responsible for providing the controller with the image data. The position coordinates of the image were acquired in a pre-processing step. This involved generating an image using the Inkspace software and exporting the results in HPGL format. The file was changed to a CSV file and our main file was responsible for extracting x and y coordinates from this file.</p>
<h2><a class="anchor" id="sec_fsm"></a>
State-Transition Diagrams</h2>
<h3><a class="anchor" id="sec_enc"></a>
Encoder Task</h3>
<p >The encoder task is responsible for getting the encoder readings to be sent to the controller task. This is accomplished by writing the encoder value into a share variable accessible to all pertaining tasks.</p>
<p >The encoder reading represents the angular position of the motor. The are two objects representing the encoders.</p>
<p > <style> div.image img[src = "encoder_fsm.png"]{width:500px}
                </style>
    </p>
<div class="image">
<img src="encoder_fsm.png" alt=""/>
<div class="caption">
Encoder State-Transition Diagram</div></div>
<h3><a class="anchor" id="sec_mot_ctrl"></a>
Motor-Controller Task</h3>
<p >The motor controller task is responsible for setting the duty cycle needed for the motor to get to the appropriate position on the surface of the pint glass. The will be two objects representing each motor.</p>
<p >The percent duty cycle is the actuation value sent from the controller. The controller calculates the actuation signal from the error value, computed from the desired value (setpoint) and the measured value (encoder reading). The setpoint is accessible in the motor-controller task as a shared variable.</p>
<p >The motor controller updates every time the measured value is within 5% of the setpoint. This allowed some tolerance needed due to the limited resolution of the encoders.</p>
<p > <style> div.image img[src = "motor_controller_fsm.png"]{width:500px}
                </style>
    </p>
<div class="image">
<img src="motor_controller_fsm.png" alt=""/>
<div class="caption">
Motor-Controller State-Transition Diagram</div></div>
<p >In addition, we have the in/out motion of the solenoid. After every setpoint was reached, the solenoid object was set low (active-low configuration) and a dot was "plotted" on the surface of the glass. This is not included in the controller state-transition diagram because this is handled on the main file.</p>
<dl class="section date"><dt>Date</dt><dd>Created: February 24, 2022 </dd>
<dd>
Modified: March 15, 2022 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Juan D. Luna </dd></dl>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
